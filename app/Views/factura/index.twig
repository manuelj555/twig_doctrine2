{% extends "template.twig" %}

{% block titulo 'Nueva Factura' %}

{% block stylesheet %}
<style type="text/css">
        #factura .row-fluid{margin-bottom: 10px}
        #factura label{width: 100px;text-align: right;margin-right: 10px}
    </style>
{% endblock %}

{% block cuerpo %}
    <form method="post" class="form-inline" id="factura">
        <input type="hidden" id="p_id" />
        <div class="row-fluid">
            <div class="span12">
                <label>CÃ©dula</label><div class="input-append cedula">
                    <input type="text" id="p_cedula"/><button class="btn" type="button">Buscar</button>
                </div>
            </div>
        </div>
        <div class="row-fluid">
            <div class="span6"><label>Nombre</label><input type="text" id="p_nombre" /></div>
        </div>
        <div class="row-fluid">
            <div class="span6"><label>Edad</label><input type="number" id="p_edad" /></div>
        </div>
        <hr/>
        <div class="row-fluid" >
            <div class="span6"><label>Articulo</label><input type="text" id="a_nombre" /></div>
        </div>
    </form>
{% endblock %}

{% block javascript %}
    <script type="text/javascript">
        $("#p_cedula").typeahead({
            source: {{ cedulas|json_encode|raw }},
            updater: function(item) {
                buscar()
                return item
            }
        })
        $('.cedula button').on('click', buscar)
        $('#p_cedula').on('keyup', function(event) {
            if (13 === event.keyCode) {
                buscar()
            }
        })

        function buscar() {
            $.getJSON('{{ path('personas/buscar') }}', {cedula: $("#p_cedula").val()}).done(function(data) {
                if (data) {
                    $("#p_id").val(data.id)
                    $("#p_nombre").val(data.nombre)
                    $("#p_edad").val(data.edad)
                }
            })
        }
        </script>
{% endblock %}